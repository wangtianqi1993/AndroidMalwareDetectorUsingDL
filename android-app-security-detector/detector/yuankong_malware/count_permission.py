# !/usr/bin/env python
# -*- coding:utf-8 -*-

__author__ = 'wtq'

import json

def count_permission(path):
    """
    count the permission times and sort it in discrease order
    :param path:
    :return:
    """
    count_per = {}
    with open(path) as f:
        permission = json.load(f)
        for key in permission:
            for per in permission[key]:
                if per not in count_per:
                    count_per[per] = 0
                count_per[per] += 1
    sort_permission = sorted(count_per.items(), key=lambda x:x[1], reverse=True)
    for item in sort_permission:
        print item


def get_permission_action(permission_list):
    with open("feature/permission_to_action.json") as f:
        permission_to_action = json.load(f)
        for per in permission_list:
            if per in permission_to_action:
                print per, permission_to_action[per]

if __name__ == "__main__":
    # count_permission("/home/wtq/develop/workspace/gitlab/android-app-security-detector/detector/yuankong_malware/feature/benign_permission.json")
    pers = []
    get_permission_action()
